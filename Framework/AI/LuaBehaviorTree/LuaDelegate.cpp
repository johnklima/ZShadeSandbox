#include "LuaDelegate.h"
#include "AISprite.h"
//==================================================================================================================================
//==================================================================================================================================
LuaDelegate::LuaDelegate(AISprite* callingSprite)
	: l(0), mLuaFile(""), mLuaFuncName(""), mCallingSprite(callingSprite)
{}
//==================================================================================================================================
LuaDelegate::LuaDelegate(string pLuaFile, string pLuaFuncName)
{
	mLuaFile = pLuaFile;
	mLuaFuncName = pLuaFuncName;
}
//==================================================================================================================================
LuaDelegate::~LuaDelegate()
{}
//==================================================================================================================================
void LuaDelegate::AddFunction(string pLuaFile, string pLuaFuncName)
{
	mLuaFile = pLuaFile;
	mLuaFuncName = pLuaFuncName;
	luaL_dofile(l, mLuaFile.c_str());
}
//==================================================================================================================================
void LuaDelegate::SetLuaState(lua_State* l)
{
	this->l = l;
}
//==================================================================================================================================
bool LuaDelegate::OnTick()
{
	lua_pcall(l, 0, 0, 0);
	lua_getglobal(l, mLuaFuncName.c_str());
	lua_pcall(l, 0, 1, 0);
	return (bool)lua_toboolean(l, -1);
}
//==================================================================================================================================